<?php

/***********************************************************************************************
* SimBrief API Demonstration                                                                   *
* Use this file to learn how to implement the SimBrief API into your Dispatch System!          *
* By Derek Mayer ( contact@simbrief.com )                                                      *
* Updated: 03/16/2014                                                                          *
*                                                                                              *
* This page does not include any styling in an effort to keep the code clean and easy to read. *
************************************************************************************************/


/*
* This page simulates the "view flightplan" area of your dispatch system. This should be where
* you have the API redirect your pilots when the flight plan has been generated. 
*
* To be able to receive the OFP data sent back from the SimBrief system, we must first include
* the SimBrief API class.
*/

include 'simbrief.apiv1.php';



/*
* And that's it! If the API redirected you to this page, it should have appended a 
* "?ofp_id=" parameter to the end of the page url. The SimBrief API will look for this parameter,
* and if it's present, will load the flightplan data into the $simbrief object. You can then
* load this data into your Dispatch System in any way you wish. The sky's the limit!
*
* It should be noted that the data files associated with generated flight plans only remain on
* the SimBrief server for a short time (less than a day), so if you would like the flight plan
* to remain available to your users for longer than that, I recommend programming your system to
* save the data locally on your own server for future use.
*
* Below I will simply var_dump the $simbrief variable to display the returned data. The variable
* contains the following data:
*
* $simbrief->ofp_id returns the OFP datafile to be fetched, as specified in the page URL
* $simbrief->ofp_avail returns whether flightplan data was loaded successfully (true/false)
* $simbrief->ofp_obj returns the data as a PHP SimpleXML Object
* $simbrief->ofp_rawxml returns the raw XML string of the data
* $simbrief->ofp_json returns the data as a JSON Object
* $simbrief->ofp_array returns the data as a standard PHP Array
*/


$xmllink = $_GET['ofp_id'];

print <<<END


<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/x-icon" href="/images/flightSmartLogoTransparent.png">
<title>flightSmart</title>
<link href='https://fonts.googleapis.com/css?family=B612 Mono' rel='stylesheet'>
<link rel="stylesheet"  href="mainstyle.css" type="text/css" />

<script type="text/javascript" src="simbrief.apiv1.js"></script>

</head>

<body>




<div class=ldgDIV style="display: flex; flex-direction: column;">
    <a href="/landing.html"><img  src="images/flightSmartTitleOG.png"  width="200" alt="flightSmart"></a>
    <a class="ldgBttonSelected" href="/fpl.html" title="Simbrief Flight Plan -> Infinite Flight"> Flight Plan Generator (via Simbrief), new!</a>
    <a class="ldgBtton" href="/index.html" title="Aircraft Calulator"> Aircraft Calculator (using Community Data!)</a>
</div>
    




<table class="flightData">
<tr> <td>


OUTPUT:





</td></tr>
</table>


<div class="WebsiteCredits">
    <br>
    <a href="https://community.infiniteflight.com/t/the-unofficial-infinite-aircraft-calculator-using-community-data/869648" target="_blank" class="myCredit">app by darkeyes â†—</a>
</div>


</div>




<script>
        function updateAircraftDropdown(options) {
    var select = document.getElementById('aircraftType');
    select.innerHTML = ''; // Clear previous options
    options.forEach(function(option) {
        var optionElement = document.createElement('option');
        optionElement.value = option;
        optionElement.textContent = option;
        select.appendChild(optionElement);
    });
}


    document.getElementById('airbusButton').addEventListener('click', function() {
        updateAircraftDropdown(['A220', 'A318', 'A319', 'A320', 'A321', 'A333', 'A339','A346', 'A359', 'A388']);
    });
    
    document.getElementById('boeingButton').addEventListener('click', function() {
        updateAircraftDropdown(['B712', 'B737', 'B738', 'B739', 'B742', 'B744', 'B748', 'B752', 'B763', 'B772', 'B77L', 'B77W', 'B77F', 'B788', 'B789', 'B78X']);
    });
    
    document.getElementById('bombardierButton').addEventListener('click', function() {
        updateAircraftDropdown(['CL350', 'CRJ2', 'CRJ7', 'CRJ9', 'CRJX', 'DH8D']);
    });
    
    document.getElementById('embraerButton').addEventListener('click', function() {
        updateAircraftDropdown(['E175', 'E190']);
    });
    
    document.getElementById('McDonnellDouglasButton').addEventListener('click', function() {
        updateAircraftDropdown(['DC10', 'DC1F', 'MD11', 'MD1F']);
    });



</script> 
</body>
</html>